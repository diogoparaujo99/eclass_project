<!DOCTYPE html>
<html> 
<head>
	<title>Image Sequence</title>
	<style>
		#container {                 /* container for dropdown and controls */
			display: flex;           /* use flexbox for horizontal layout */
			align-items: center;     /* vertically align items */
			justify-content: left;   /* centers the content horizontally*/
			margin-bottom: 10px;     /* add some space below */
		}
		#sequence {
			max-width: 100%;
			display: block;
			margin: 0 auto;
		}
		.controls {
			margin-left: 50px; 
			display: flex;  /* use flexbox for horizontal layout of buttons */
			gap: 5px;       /* add some space between buttons */
		}
		.reset {
			margin-left: 50px; 
			display: flex; 
		}
	</style>
</head>
<body>
	<div id="container">
		<select id="directorySelect" onchange="changeDirectory()">
            <option value="grid-N20__obstacles-0.0__maxsteps-100__policy-random__dummy-False">grid-N20__obstacles-0.0__maxsteps-100__policy-random__dummy-False</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi1">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi1</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi2">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi2</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi3">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False-viterbi3</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False4">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False4</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False5">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False5</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False6">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-False6</option>
            <option value="grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-True">grid-N20__obstacles-0.1__maxsteps-100__policy-random__dummy-True</option>
            <option value="grid-N20__obstacles-0.3__maxsteps-100__policy-random__dummy-False">grid-N20__obstacles-0.3__maxsteps-100__policy-random__dummy-False</option>
            <option value="grid-N20__obstacles-0.5__maxsteps-100__policy-random__dummy-False">grid-N20__obstacles-0.5__maxsteps-100__policy-random__dummy-False</option>
            <option value="grid-N30__obstacles-0.3__maxsteps-100__policy-random__dummy-False">grid-N30__obstacles-0.3__maxsteps-100__policy-random__dummy-False</option>
            <option value="grid-N30__obstacles-0.5__maxsteps-100__policy-random__dummy-False">grid-N30__obstacles-0.5__maxsteps-100__policy-random__dummy-False</option>
		</select>
		<div class="controls">
			<button onclick="prevFrame()">Previous</button>
			<button onclick="togglePlay()">Play/Pause</button>
			<button onclick="nextFrame()">Next</button>
		</div>
		<div class="reset">
			<button onclick="toggleReset()">Reset</button>
		</div>
	</div>
	<img id="sequence" src="results/grid-N20__obstacles-0.0__maxsteps-100__policy-random__dummy-False/frame-0.png">

	<script>
		let currentDirectory = "grid-N20__obstacles-0.0__maxsteps-100__policy-random__dummy-False"; // initial directory
		let numFrames = 0;
		let currentFrame = 0;
		let isPlaying = false;
		let intervalId;
		const imageElement = document.getElementById('sequence');

		function updateFrame() {
			imageElement.src = `results/${currentDirectory}/frame-${currentFrame}.png`;
		}

		function nextFrame() {
			currentFrame = (currentFrame + 1) % numFrames;
			updateFrame();
		}

		function prevFrame() {
			currentFrame = (currentFrame - 1 + numFrames) % numFrames;
			updateFrame();
		}

		function play() {
			intervalId = setInterval(nextFrame, 250);
		}

		function pause() {
			clearInterval(intervalId);
		}

		function reset() {
			currentFrame = 0;
			updateFrame();
		}

		function togglePlay() {
			isPlaying = !isPlaying;
			if (isPlaying) {
				play();
			} else {
				pause();
			}
		}

		function toggleReset() {
			reset();
		}

		function changeDirectory() {
			currentDirectory = document.getElementById("directorySelect").value;
			// extract numFrames from directory name
			const parts = currentDirectory.split("_");
			if (parts.length === 2) {
				numFrames = parseInt(parts[1], 10);
			} else {
				console.error("Invalid directory name format:", currentDirectory);
				numFrames = 100;
			}
			currentFrame = 0; // reset frame
			updateFrame(); // update the displayed image
		}

		// initial setup (extract numFrames from initial directory)
		const initialParts = currentDirectory.split("_");
		if (initialParts.length === 3) {
			numFrames = parseInt(initialParts[2].split("-")[1], 10);
		} else {
			console.error("Invalid initial directory name format:", currentDirectory);
			numFrames = 100; // or some default value
		}
		updateFrame();// initial display
	</script>
</body> 
</html>